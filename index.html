<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Badanie Echokardiograficzne</title>
  <!-- Biblioteki do eksportu DOCX -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.4.1/html-docx.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .form-section { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; }
    input[type="text"], input[type="number"], input[type="date"], select, textarea { width: 100%; max-width: 300px; padding: 5px; margin-top: 2px; }
    h2 { margin-top: 30px; }
    button { padding: 10px 20px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>Badanie Echokardiograficzne</h1>
  <form id="echoForm">
    <div class="form-section">
      <label>Data badania:
        <input type="date" id="date" />
      </label>
    </div>
    <div class="form-section">
      <label>Pacjent:
        <input type="text" id="patient" />
      </label>
    </div>

    <h2>Wymiary jam serca</h2>
    <div class="form-section">
      <label>LV (mm): <input type="number" id="LV" /></label>
      <label>LA (mm): <input type="number" id="LA" /></label>
      <label>LAA (cm²): <input type="number" id="LAA" step="0.01" /></label>
      <label>RV (mm): <input type="number" id="RV" /></label>
      <label>RAA (cm²): <input type="number" id="RAA" step="0.01" /></label>
    </div>
    <div class="form-section">
      <label>IVS (mm): <input type="number" id="IVS" /></label>
      <label>PW (mm): <input type="number" id="PW" /></label>
    </div>

    <h2>Szerokość pni naczyniowych</h2>
    <div class="form-section">
      <label>Ao op (mm): <input type="number" id="Ao_op" /></label>
      <label>Ao asc (mm): <input type="number" id="Ao_asc" /></label>
      <label>PA (mm): <input type="number" id="PA" /></label>
    </div>

    <div class="form-section">
      <label>Frakcja wyrzutowa (EF, %):
        <input type="number" id="EF" /></label>
    </div>
    <div class="form-section">
      <label>Regionalne zaburzenia kurczliwości:
        <select id="regional">
          <option value="">--</option>
          <option value="NIE">NIE</option>
          <option value="TAK">TAK</option>
        </select>
      </label>
    </div>

    <h2>Zastawki</h2>
    <div class="form-section">
      <h3>Mitralna</h3>
      <label>E/A: <input type="text" id="mitral_EA" /></label>
      <label>MR VC (mm): <input type="number" id="MR_VC" /></label>
      <label>PISA (mm): <input type="number" id="PISA" /></label>
      <label>LAA (cm²): <input type="number" id="mitral_LAA" step="0.01" /></label>
      <label>Jet area (cm²): <input type="number" id="jet_area" step="0.01" /></label>
      <label>MS MxPG (mmHg): <input type="number" id="MS_MxPG" /></label>
      <label>MS MnPG (mmHg): <input type="number" id="MS_MnPG" /></label>
      <label>Vmax (m/s): <input type="number" id="MS_Vmax" step="0.01" /></label>
      <label>SPAP (mmHg): <input type="number" id="SPAP" /></label>
    </div>

    <div class="form-section">
      <h3>Aortalna</h3>
      <label>AR VC (mm): <input type="number" id="AR_VC" /></label>
      <label>Szerokość fali (mm): <input type="number" id="wave_width" /></label>
      <label>LVOT (mm): <input type="number" id="LVOT" /></label>
      <label>PHT (m/s): <input type="number" id="PHT" /></label>
      <label>AS MxPG (mmHg): <input type="number" id="AS_MxPG" /></label>
      <label>AS MnPG (mmHg): <input type="number" id="AS_MnPG" /></label>
      <label>Vmax (m/s): <input type="number" id="AS_Vmax" step="0.01" /></label>
      <label>AVA (cm²): <input type="number" id="AVA" step="0.01" /></label>
    </div>

    <div class="form-section">
      <h3>Trójdzielna</h3>
      <label>VC (mm): <input type="number" id="tri_VC" /></label>
      <label>Jet area (cm²): <input type="number" id="tri_jet" step="0.01" /></label>
      <label>MxPG (mmHg): <input type="number" id="tri_MxPG" /></label>
      <label>TAPSE (mm): <input type="number" id="TAPSE" /></label>
      <label>SPAP (mmHg): <input type="number" id="tri_SPAP" /></label>
    </div>

    <div class="form-section">
      <h3>Pnia płucnego</h3>
      <label>AcT (m/s): <input type="number" id="AcT" step="0.01" /></label>
      <label>Vmax systole (m/s): <input type="number" id="Vmax_sys" step="0.01" /></label>
      <label>Vmax diastole (m/s): <input type="number" id="Vmax_dia" step="0.01" /></label>
      <label>RVSP (mmHg): <input type="number" id="RVSP" /></label>
    </div>

    <div class="form-section">
      <label>Osierdzie:
        <select id="osierdzie">
          <option value="">--</option>
          <option value="bez płynu">bez płynu</option>
          <option value="z płynem">z płynem</option>
        </select>
      </label>
    </div>

    <div class="form-section">
      <label>Opis dodatkowy:<br>
        <textarea id="opis" rows="4" cols="50"></textarea>
      </label>
    </div>

    <div class="form-section">
      <label>Wnioski:<br>
        <textarea id="wnioski" rows="4" cols="50"></textarea>
      </label>
    </div>

    <button type="button" onclick="generateReport()">Eksportuj do DOCX</button>
  </form>

  <div id="report" style="display:none;"></div>

  <script>
    function generateReport() {
      const fields = ["date","patient","LV","LA","LAA","RV","RAA","IVS","PW","Ao_op","Ao_asc","PA","EF","regional","mitral_EA","MR_VC","PISA","mitral_LAA","jet_area","MS_MxPG","MS_MnPG","MS_Vmax","SPAP","AR_VC","wave_width","LVOT","PHT","AS_MxPG","AS_MnPG","AS_Vmax","AVA","tri_VC","tri_jet","tri_MxPG","TAPSE","tri_SPAP","AcT","Vmax_sys","Vmax_dia","RVSP","osierdzie","opis","wnioski"];
      let html = '<h1>Badanie Echokardiograficzne</h1>';
      fields.forEach(id => {
        const el = document.getElementById(id);
        if (el && el.value) {
          const label = document.querySelector('label[for="'+id+'"]') || el.parentElement;
          html += `<p><strong>${label.textContent.trim()}</strong> ${el.value}</p>`;
        }
      });
      const report = document.getElementById("report");
      report.innerHTML = html;
      const converted = htmlDocx.asBlob(report.innerHTML);
      saveAs(converted, "raport.docx");
    }
  </script>
</body>
</html>
